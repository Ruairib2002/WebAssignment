<h1>Resolve Issues</h1>

<%= notice %>
<%= alert %>

<table class="table table-bordered">
  <thead>
    <tr>
      <th>Category</th>
      <th>Description</th>
      <th>Location</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% @issues.each do |issue| %>
    <tr>
      <td><%= issue.category %></td>
      <td><%= issue.description %></td>
      <td><%= "#{issue.latitude}, #{issue.longitude}" %></td>
      <td>
        <% if issue.active? %>
        <%= form_for issue, url: resolve_issue_path(issue), method: :patch do |f| %>
        <%= f.hidden_field :active, value: false %>
        <%= f.submit "Mark as Resolved", class: "btn btn-primary" %>
        <% end %>
        <% else %>
        <span class="text-success">Resolved</span>
        <% end %>
      </td>
    </tr>
    <tr>
      <td colspan="4">
        <div style="text-align: center;">
          <img src="https://maps.googleapis.com/maps/api/staticmap?center=<%= issue.latitude %>,<%= issue.longitude %>&zoom=14&size=300x200&markers=color:red|label:â€¢|<%= issue.latitude %>,<%= issue.longitude %>&key=AIzaSyCmHtKK6Khdr2koqAakd0JrpNcYQJCJBpA" alt="Issue Location Map" style="max-width: 100%; height: auto;">
        </div>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>

<%= link_to 'Back to Issues List', issues_path, class: 'btn btn-secondary' %>